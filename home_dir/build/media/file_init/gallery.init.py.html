<!DOCTYPE html>
<html>
    <head>
        <title> init.template </title>
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="date" content="2013-02-03 20:02:38" />
        <meta name="generator" content="Marboo 0.5: http://marboo.biz" />
        <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css" media="screen" />
        <link rel="stylesheet" type="text/css" href="/media/css/pygmentize-default.css" media="screen" />
        <link rel="stylesheet" type="text/css" href="/media/css/marboo.css" media="screen" />
    </head>
    <body style="background-color:transparent">
        <h3>gallery.init.py</h3>
source code:
<div class="highlight"><pre><span class="c">#!/usr/bin/python</span>
<span class="c"># author: amoblin &lt;amoblin@gmail.com&gt;</span>
<span class="c"># Note:</span>
<span class="c"># This file is auto generated by Marboo from /media/bin/gallery.py.</span>
<span class="c"># If you want to change the image gallery UI, modify the file /media/bin/gallery.py.</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">mimetypes</span>
<span class="n">mimetypes</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

<span class="n">source</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s">&quot;~&quot;</span><span class="p">),</span> <span class="s">&quot;.marboo/source&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_url_path</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

<span class="n">dir_name</span> <span class="o">=</span> <span class="s">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">__file__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="k">if</span> <span class="n">dir_name</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&quot;&lt;h3&gt; </span><span class="si">%s</span><span class="s"> gallery &lt;/h3&gt;&quot;</span> <span class="o">%</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span> <span class="n">dir_name</span> <span class="p">):</span>
        <span class="n">mime</span> <span class="o">=</span> <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">mime</span> <span class="ow">and</span> <span class="n">mime</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;image&quot;</span><span class="p">:</span>
            <span class="n">url_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_url_path</span><span class="p">(</span><span class="n">dir_name</span><span class="p">),</span> <span class="n">filename</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&quot;&quot;&quot;        &lt;div class=&quot;span4&quot;&gt;</span>
<span class="s">            &lt;a href=&quot;</span><span class="si">%s</span><span class="s">&quot;&gt;</span>
<span class="s">                &lt;img src=&quot;</span><span class="si">%s</span><span class="s">&quot;&gt;</span>
<span class="s">            &lt;/a&gt;</span>
<span class="s">            &lt;p&gt; </span><span class="si">%s</span><span class="s"> &lt;/p&gt;</span>
<span class="s">        &lt;/div&gt;&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">url_path</span><span class="p">,</span> <span class="n">url_path</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</pre></div>

        <script src="/bootstrap/js/bootstrap.min.js"></script>
    </body>
</html>
